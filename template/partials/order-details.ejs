<!-- Order Header -->
<% if ((typeof showHeader === 'undefined' || showHeader) && order.orderCode && order.createdAt) { %>
  <div class="order-row order-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
    <h2 style="margin: 0; font-size: 24px;">ƒê∆°n h√†ng #<%= order.orderCode %></h2>
    <p style="margin: 5px 0 0 0; opacity: 0.9;">Ng√†y ƒë·∫∑t: <%= new Date(order.createdAt).toLocaleDateString('vi-VN') %></p>
  </div>
<% } %>

<%
// X·ª≠ l√Ω m√†u v√† icon cho status
let statusBg = '#E0E0E0';
let statusColor = '#333';
let statusIcon = '‚è≥';
switch (order.status) {
  case 'Ch·ªù x√°c nh·∫≠n':
    statusBg = '#FFA000'; statusColor = '#fff'; statusIcon = '‚è≥'; break;
  case 'ƒê√£ x√°c nh·∫≠n':
    statusBg = '#1976D2'; statusColor = '#fff'; statusIcon = '‚úÖ'; break;
  case 'ƒêang giao':
    statusBg = '#00BCD4'; statusColor = '#fff'; statusIcon = 'üöö'; break;
  case 'Ho√†n th√†nh':
    statusBg = '#388E3C'; statusColor = '#fff'; statusIcon = 'üéâ'; break;
  case 'ƒê√£ h·ªßy':
    statusBg = '#D32F2F'; statusColor = '#fff'; statusIcon = '‚ùå'; break;
  default:
    statusBg = '#E0E0E0'; statusColor = '#333'; statusIcon = '‚è≥';
}
%>

<%
let paymentIcon = 'üí≥';
switch (order.paymentMethod) {
  case 'Ti·ªÅn m·∫∑t':
    paymentIcon = 'üíµ'; break;
  case 'Chuy·ªÉn kho·∫£n':
    paymentIcon = 'üè¶'; break;
  case 'PENDING':
    paymentIcon = '‚è≥'; break;
  default:
    paymentIcon = 'üí≥';
}
%>

<!-- Status Row -->
<% if ((typeof showStatus === 'undefined' || showStatus) && (order.status || order.paymentMethod)) { %>
  <div class="order-row status-row" style="display: flex; justify-content: space-between; padding: 15px; background: #f8f9fa; border-radius: 6px; margin-bottom: 20px;">
    <% if (order.status) { %>
      <div style="display: flex; align-items: center; width: 100%;">
        <span style="font-size: 20px; margin-right: 8px;"><%= statusIcon %></span>
        <strong style="
          white-space: nowrap;
          border-radius: 16px;
          padding: 5px 16px;
          font-weight: 500;
          font-size: 15px;
          background: <%= statusBg %>;
          color: <%= statusColor %>;
          display: inline-block;
          box-shadow: 0 1px 4px rgba(0,0,0,0.08);
          letter-spacing: 0.5px;"
        >
          <%= order.status %>
        </strong>
      </div>
    <% } %>
    <% if (order.paymentMethod) { %>
      <div style="display: flex; align-items: center;">
        <span style="font-size: 20px; margin-right: 8px;"><%= paymentIcon %></span>
        <strong style="white-space: nowrap;">
          <%= order.paymentMethod %>
        </strong>
      </div>
    <% } %>
  </div>
<% } %>

<!-- Products Section -->
<% if (typeof showProducts === 'undefined' || showProducts === true) { %>
  <% if (order.orderItems && order.orderItems.length > 0) { %>
    <div class="order-row products-section" style="margin-bottom: 25px;">
      <h3 style="color: #333; margin-bottom: 15px;">S·∫£n ph·∫©m</h3>
      <% order.orderItems.forEach(function(item) { %>
        <div class="product-item" style="display: flex; align-items: center; margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 6px;">
          <div class="product-image" style="width: 60px; height: 60px; background: #ddd; border-radius: 4px; margin-right: 15px; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #666;">
            <% if (item.productThumbnail) { %>
              <img src="<%= frefixStatic %>/<%= item.productThumbnail %>" alt="<%= item.productName %>" style="width: 100%; height: 100%; object-fit: cover; border-radius: 4px;">
            <% } else { %>
              IMG
            <% } %>
          </div>
          <div class="product-details" style="flex: 1;">
            <div style="font-weight: bold; margin-bottom: 5px;"><%= item.productName %></div>
            <div style="font-size: 12px; color: #666; margin-bottom: 5px;"><%= item.productCode %></div>
            <div style="color: #e74c3c;">(<%= item.price.toLocaleString() %>ƒë) x <%= item.quantity %> = <%= item.total.toLocaleString() %>ƒë</div>
          </div>
        </div>
      <% }); %>
    </div>
  <% } %>
<% } %>

<!-- Delivery Info -->
<% if (typeof showDelivery === 'undefined' || showDelivery === true) { %>
  <% if (order.delivery) { %>
    <div class="order-row delivery-section" style="margin-bottom: 25px;">
      <h3 style="color: #333; margin-bottom: 15px;">Th√¥ng tin giao h√†ng</h3>
      <div style="background: #f8f9fa; padding: 20px; border-radius: 6px;">
        <div style="display: flex; margin-bottom: 10px;">
          <div style="width: 120px; min-width: 120px; font-weight: bold;">Ng∆∞·ªùi nh·∫≠n:</div>
          <div style="flex: 1;"><%= order.delivery.name %></div>
        </div>
        <div style="display: flex; margin-bottom: 10px;">
          <div style="width: 120px; min-width: 120px; font-weight: bold;">S·ªë ƒëi·ªán tho·∫°i:</div>
          <div style="flex: 1;"><%= order.delivery.phoneNumber %></div>
        </div>
        <div style="display: flex;">
          <div style="width: 120px; min-width: 120px; font-weight: bold;">ƒê·ªãa ch·ªâ:</div>
          <div style="flex: 1;"><%= order.delivery.addressDetail %></div>
        </div>
      </div>
    </div>
  <% } %>
<% } %>

<!-- Order Summary -->
<% if (typeof showSummary === 'undefined' || showSummary === true) { %>
  <div class="order-row summary-section" style="margin-bottom: 25px;">
    <h3 style="color: #333; margin-bottom: 15px;">T·ªïng k·∫øt ƒë∆°n h√†ng</h3>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 6px;">
      <% if (typeof order.subTotal !== 'undefined') { %>
        <div style="display: flex; margin-bottom: 10px;">
          <span style="width: 120px; min-width: 120px; font-weight: bold;">T·∫°m t√≠nh: </span>
          <span><%= order.subTotal.toLocaleString() %>ƒë</span>
        </div>
      <% } %>
      <% if (typeof order.deliveryFee !== 'undefined') { %>
        <div style="display: flex; margin-bottom: 10px;">
          <span style="width: 120px; min-width: 120px; font-weight: bold;">Ph√≠ giao h√†ng: </span>
          <span><%= order.deliveryFee.toLocaleString() %>ƒë</span>
        </div>
      <% } %>
      <% if (typeof order.discount !== 'undefined' && order.discount > 0) { %>
        <div style="display: flex; margin-bottom: 10px;">
          <span style="width: 120px; min-width: 120px; font-weight: bold;">Gi·∫£m gi√°: </span>
          <span>-<%= order.discount.toLocaleString() %>ƒë</span>
        </div>
      <% } %>
      <div style="display: flex; font-size: 18px; font-weight: bold; color: #e74c3c; border-top: 1px solid #999999; padding-top: 10px; margin-top: 10px;">
        <span style="width: 120px; min-width: 120px; font-weight: bold;">T·ªïng c·ªông: </span>
        <span><%= order.total.toLocaleString() %>ƒë</span>
      </div>
    </div>
  </div>
<% } %>